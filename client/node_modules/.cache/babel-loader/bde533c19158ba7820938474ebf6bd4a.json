{"ast":null,"code":"var _jsxFileName = \"/Users/riva/Downloads/Cap_exper/client/src/Spotistuff/Online.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, memo, useRef } from 'react';\nimport '../Css/Online.css';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Online = /*#__PURE__*/_s( /*#__PURE__*/memo(_c = _s(props => {\n  _s();\n\n  //console.log(\"Online Component\");\n  const [open, setOpen] = useState(false);\n  const [onlineClicked, setOnlineClicked] = useState(false);\n  const addingTrack = useRef();\n  const userInfo = useRef();\n  let curTracks;\n  useEffect(() => {\n    //console.log(\"In useEffect\")\n    axios('https://api.spotify.com/v1/me', {\n      method: 'GET',\n      headers: {\n        'Authorization': 'Bearer ' + props.logInfo\n      }\n    }).then(response => {\n      userInfo.current = response.data;\n    });\n  }, [props.logInfo]);\n  useEffect(() => {\n    const handleClickInside = event => {\n      if (open && props.inputRef.current.contains(event.target)) {\n        setOpen(false);\n      } else if (props.inputRef.current.contains(event.target)) {\n        setOnlineClicked(true);\n      } else if (document.activeElement.className !== \"AddButton\") {\n        setOnlineClicked(false);\n\n        if (open) {\n          setOpen(false);\n        }\n      }\n    };\n\n    document.addEventListener(\"click\", handleClickInside);\n    return () => {\n      document.removeEventListener(\"click\", handleClickInside);\n    };\n  }, [open]);\n\n  const addSongClicked = async addingId => {\n    let addSong = false;\n    curTracks = await props.getPlaylist(0, curTracks, addingId);\n\n    for (const item of curTracks) {\n      if (item.track.uri === addingTrack.current) {\n        alert(\"Song already in the playlist\");\n        break;\n      } else if (item === curTracks[curTracks.length - 1]) {\n        addSong = true;\n      }\n    }\n\n    if (addSong) {\n      curTracks = null;\n      axios(`https://api.spotify.com/v1/playlists/${addingId}/tracks`, {\n        method: \"POST\",\n        headers: {\n          'Authorization': 'Bearer ' + props.logInfo\n        },\n        data: {\n          \"uris\": [addingTrack.current]\n        }\n      }).then(async _ => {\n        curTracks = await props.getPlaylist(0, curTracks, addingId);\n\n        if (addingId === props.playlists.current.selectedPlaylist) {\n          props.setDispPlaylist(curTracks);\n\n          if (props.playlistTrack.current === props.playlists.current.selectedPlaylist) {\n            props.setTracks({\n              selectedTrack: props.tracks.selectedTrack,\n              listOfTracksFromApi: curTracks\n            });\n          }\n        } else if (props.playlistTrack.current === addingId) {\n          props.setTracks({\n            selectedTrack: props.tracks.selectedTrack,\n            listOfTracksFromApi: curTracks\n          });\n        }\n      });\n    }\n  };\n\n  const seePlaylists = e => {\n    document.getElementById(\"PopUp\").style.marginTop = e.currentTarget.id + \"px\";\n\n    if (!open || addingTrack.current && addingTrack.current === e.currentTarget.value) {\n      setOpen(!open);\n    }\n\n    addingTrack.current = e.currentTarget.value;\n  };\n\n  const addTheSong = e => {\n    addSongClicked(e.target.id);\n  };\n\n  return onlineClicked && props.songs ? /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"AboveOnline\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"Online\",\n      children: [/*#__PURE__*/_jsxDEV(\"link\", {\n        rel: \"stylesheet\",\n        href: \"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), typeof props.songs === \"object\" ? props.songs.tracks.items.map((item, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"AddParent\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          id: idx * 23 + 57,\n          value: item.uri,\n          onClick: seePlaylists,\n          className: \"AddButton\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fa fa-plus\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"AddMessage\",\n            children: \"\\xA0Add to playlist\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 45\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 50\n        }, this), item.name, \": \", item.artists[0].name]\n      }, idx, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\" '\", props.songs, \"' does not exist \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"PopUp\",\n      className: \"PopUp\",\n      children: open && props.playlists.current.listOfPlaylistsFromAPI.map((item, idx) => userInfo.current.display_name === item.owner.display_name && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"AddToPlay\",\n        id: item.id,\n        onClick: addTheSong,\n        children: item.name\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 5\n  }, this) : null;\n}, \"Sxni43NSJ0qmVvBAtzJ/M3KsjoI=\")), \"Sxni43NSJ0qmVvBAtzJ/M3KsjoI=\");\n\n_c2 = Online;\nexport default Online;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Online$memo\");\n$RefreshReg$(_c2, \"Online\");","map":{"version":3,"sources":["/Users/riva/Downloads/Cap_exper/client/src/Spotistuff/Online.js"],"names":["React","useState","useEffect","memo","useRef","axios","Online","props","open","setOpen","onlineClicked","setOnlineClicked","addingTrack","userInfo","curTracks","method","headers","logInfo","then","response","current","data","handleClickInside","event","inputRef","contains","target","document","activeElement","className","addEventListener","removeEventListener","addSongClicked","addingId","addSong","getPlaylist","item","track","uri","alert","length","_","playlists","selectedPlaylist","setDispPlaylist","playlistTrack","setTracks","selectedTrack","tracks","listOfTracksFromApi","seePlaylists","e","getElementById","style","marginTop","currentTarget","id","value","addTheSong","songs","items","map","idx","name","artists","listOfPlaylistsFromAPI","display_name","owner"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,QAAf,EAAyBC,SAAzB,EAAoCC,IAApC,EAA0CC,MAA1C,QAAuD,OAAvD;AACA,OAAO,mBAAP;AACA,OAAOC,KAAP,MAAkB,OAAlB;;;AAEA,MAAMC,MAAM,iCAAGH,IAAI,SAACI,KAAK,IAAG;AAAA;;AAC1B;AACA,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAgBR,QAAQ,CAAC,KAAD,CAA9B;AACA,QAAM,CAACS,aAAD,EAAgBC,gBAAhB,IAAkCV,QAAQ,CAAC,KAAD,CAAhD;AACA,QAAMW,WAAW,GAACR,MAAM,EAAxB;AACA,QAAMS,QAAQ,GAACT,MAAM,EAArB;AACA,MAAIU,SAAJ;AAEAZ,EAAAA,SAAS,CAAC,MAAK;AACb;AACAG,IAAAA,KAAK,CAAC,+BAAD,EAAkC;AACnCU,MAAAA,MAAM,EAAE,KAD2B;AAEnCC,MAAAA,OAAO,EAAE;AAAC,yBAAkB,YAAYT,KAAK,CAACU;AAArC;AAF0B,KAAlC,CAAL,CAIGC,IAJH,CAISC,QAAD,IAAc;AAClBN,MAAAA,QAAQ,CAACO,OAAT,GAAiBD,QAAQ,CAACE,IAA1B;AACD,KANH;AAOD,GATQ,EASP,CAACd,KAAK,CAACU,OAAP,CATO,CAAT;AAWAf,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMoB,iBAAiB,GAAGC,KAAK,IAAE;AAC/B,UAAGf,IAAI,IAAID,KAAK,CAACiB,QAAN,CAAeJ,OAAf,CAAuBK,QAAvB,CAAgCF,KAAK,CAACG,MAAtC,CAAX,EAAyD;AACvDjB,QAAAA,OAAO,CAAC,KAAD,CAAP;AACD,OAFD,MAGK,IAAGF,KAAK,CAACiB,QAAN,CAAeJ,OAAf,CAAuBK,QAAvB,CAAgCF,KAAK,CAACG,MAAtC,CAAH,EAAiD;AACpDf,QAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACD,OAFI,MAGA,IAAIgB,QAAQ,CAACC,aAAT,CAAuBC,SAAvB,KAAmC,WAAvC,EAAmD;AACtDlB,QAAAA,gBAAgB,CAAC,KAAD,CAAhB;;AACA,YAAGH,IAAH,EAAQ;AACNC,UAAAA,OAAO,CAAC,KAAD,CAAP;AACD;AACF;AACF,KAbD;;AAcAkB,IAAAA,QAAQ,CAACG,gBAAT,CAA0B,OAA1B,EAAmCR,iBAAnC;AACA,WAAO,MAAM;AACXK,MAAAA,QAAQ,CAACI,mBAAT,CAA6B,OAA7B,EAAsCT,iBAAtC;AACD,KAFD;AAGD,GAnBQ,EAmBN,CAACd,IAAD,CAnBM,CAAT;;AAqBA,QAAMwB,cAAc,GAAC,MAAMC,QAAN,IAAgB;AACnC,QAAIC,OAAO,GAAC,KAAZ;AACApB,IAAAA,SAAS,GAAG,MAAMP,KAAK,CAAC4B,WAAN,CAAkB,CAAlB,EAAqBrB,SAArB,EAAgCmB,QAAhC,CAAlB;;AACA,SAAI,MAAMG,IAAV,IAAkBtB,SAAlB,EAA4B;AAC1B,UAAGsB,IAAI,CAACC,KAAL,CAAWC,GAAX,KAAiB1B,WAAW,CAACQ,OAAhC,EAAwC;AACtCmB,QAAAA,KAAK,CAAC,8BAAD,CAAL;AACA;AACD,OAHD,MAIK,IAAGH,IAAI,KAAGtB,SAAS,CAACA,SAAS,CAAC0B,MAAV,GAAiB,CAAlB,CAAnB,EAAwC;AAC3CN,QAAAA,OAAO,GAAC,IAAR;AACD;AACF;;AACD,QAAGA,OAAH,EAAW;AACTpB,MAAAA,SAAS,GAAC,IAAV;AACAT,MAAAA,KAAK,CAAE,wCAAuC4B,QAAS,SAAlD,EAA4D;AAC/DlB,QAAAA,MAAM,EAAE,MADuD;AAE/DC,QAAAA,OAAO,EAAE;AAAC,2BAAkB,YAAYT,KAAK,CAACU;AAArC,SAFsD;AAG/DI,QAAAA,IAAI,EAAE;AAAE,kBAAQ,CAACT,WAAW,CAACQ,OAAb;AAAV;AAHyD,OAA5D,CAAL,CAKCF,IALD,CAKO,MAAMuB,CAAN,IAAW;AAChB3B,QAAAA,SAAS,GAAG,MAAMP,KAAK,CAAC4B,WAAN,CAAkB,CAAlB,EAAqBrB,SAArB,EAAgCmB,QAAhC,CAAlB;;AACA,YAAGA,QAAQ,KAAG1B,KAAK,CAACmC,SAAN,CAAgBtB,OAAhB,CAAwBuB,gBAAtC,EAAuD;AACrDpC,UAAAA,KAAK,CAACqC,eAAN,CAAsB9B,SAAtB;;AACA,cAAGP,KAAK,CAACsC,aAAN,CAAoBzB,OAApB,KAA8Bb,KAAK,CAACmC,SAAN,CAAgBtB,OAAhB,CAAwBuB,gBAAzD,EAA0E;AACxEpC,YAAAA,KAAK,CAACuC,SAAN,CAAgB;AAACC,cAAAA,aAAa,EAAExC,KAAK,CAACyC,MAAN,CAAaD,aAA7B;AAA4CE,cAAAA,mBAAmB,EAAEnC;AAAjE,aAAhB;AACD;AACF,SALD,MAMK,IAAGP,KAAK,CAACsC,aAAN,CAAoBzB,OAApB,KAA8Ba,QAAjC,EAA0C;AAC7C1B,UAAAA,KAAK,CAACuC,SAAN,CAAgB;AAACC,YAAAA,aAAa,EAAExC,KAAK,CAACyC,MAAN,CAAaD,aAA7B;AAA4CE,YAAAA,mBAAmB,EAAEnC;AAAjE,WAAhB;AACD;AACF,OAhBD;AAiBD;AACF,GAhCD;;AAkCA,QAAMoC,YAAY,GAACC,CAAC,IAAE;AACpBxB,IAAAA,QAAQ,CAACyB,cAAT,CAAwB,OAAxB,EAAiCC,KAAjC,CAAuCC,SAAvC,GAAiDH,CAAC,CAACI,aAAF,CAAgBC,EAAhB,GAAmB,IAApE;;AACA,QAAG,CAAChD,IAAD,IAAUI,WAAW,CAACQ,OAAZ,IAAuBR,WAAW,CAACQ,OAAZ,KAAsB+B,CAAC,CAACI,aAAF,CAAgBE,KAA1E,EAAiF;AAC/EhD,MAAAA,OAAO,CAAC,CAACD,IAAF,CAAP;AACD;;AACDI,IAAAA,WAAW,CAACQ,OAAZ,GAAoB+B,CAAC,CAACI,aAAF,CAAgBE,KAApC;AACD,GAND;;AAQA,QAAMC,UAAU,GAACP,CAAC,IAAG;AACnBnB,IAAAA,cAAc,CAACmB,CAAC,CAACzB,MAAF,CAAS8B,EAAV,CAAd;AACD,GAFD;;AAIA,SAAQ9C,aAAa,IAAIH,KAAK,CAACoD,KAAvB,gBACN;AAAK,IAAA,SAAS,EAAC,aAAf;AAAA,4BACE;AAAK,MAAA,SAAS,EAAE,QAAhB;AAAA,8BACE;AAAM,QAAA,GAAG,EAAC,YAAV;AAAuB,QAAA,IAAI,EAAC;AAA5B;AAAA;AAAA;AAAA;AAAA,cADF,EAEG,OAAOpD,KAAK,CAACoD,KAAb,KAAsB,QAAtB,GACCpD,KAAK,CAACoD,KAAN,CAAYX,MAAZ,CAAmBY,KAAnB,CAAyBC,GAAzB,CAA6B,CAACzB,IAAD,EAAO0B,GAAP,kBAC3B;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA,gCAAqC;AAAQ,UAAA,EAAE,EAAEA,GAAG,GAAC,EAAJ,GAAO,EAAnB;AAAuB,UAAA,KAAK,EAAI1B,IAAI,CAACE,GAArC;AAA0C,UAAA,OAAO,EAAEY,YAAnD;AAAiE,UAAA,SAAS,EAAC,WAA3E;AAAA,kCACnC;AAAG,YAAA,SAAS,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,kBADmC,eACL;AAAK,YAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADK;AAAA;AAAA;AAAA;AAAA;AAAA,gBAArC,EACkGd,IAAI,CAAC2B,IADvG,QAC+G3B,IAAI,CAAC4B,OAAL,CAAa,CAAb,EAAgBD,IAD/H;AAAA,SAAgCD,GAAhC;AAAA;AAAA;AAAA;AAAA,cADF,CADD,gBAIC;AAAA,yBAAQvD,KAAK,CAACoD,KAAd;AAAA;AAAA;AAAA;AAAA;AAAA,cANJ;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eASE;AAAK,MAAA,EAAE,EAAE,OAAT;AAAiB,MAAA,SAAS,EAAC,OAA3B;AAAA,gBACCnD,IAAI,IAAID,KAAK,CAACmC,SAAN,CAAgBtB,OAAhB,CAAwB6C,sBAAxB,CAA+CJ,GAA/C,CAAmD,CAACzB,IAAD,EAAO0B,GAAP,KAAejD,QAAQ,CAACO,OAAT,CAAiB8C,YAAjB,KAAgC9B,IAAI,CAAC+B,KAAL,CAAWD,YAA3C,iBACzE;AAAQ,QAAA,SAAS,EAAC,WAAlB;AAAwC,QAAA,EAAE,EAAI9B,IAAI,CAACoB,EAAnD;AAAuD,QAAA,OAAO,EAAEE,UAAhE;AAAA,kBAA6EtB,IAAI,CAAC2B;AAAlF,SAAmCD,GAAnC;AAAA;AAAA;AAAA;AAAA,cADO;AADT;AAAA;AAAA;AAAA;AAAA,YATF;AAAA;AAAA;AAAA;AAAA;AAAA,UADM,GAeG,IAfX;AAiBD,CAvGkB,kCAAP,iCAAZ;;MAAMxD,M;AAwGN,eAAeA,MAAf","sourcesContent":["import React, {useState, useEffect, memo, useRef} from 'react';\r\nimport '../Css/Online.css';\r\nimport axios from 'axios';\r\n\r\nconst Online = memo(props=> {\r\n  //console.log(\"Online Component\");\r\n  const [open, setOpen]=useState(false);\r\n  const [onlineClicked, setOnlineClicked]=useState(false);\r\n  const addingTrack=useRef();\r\n  const userInfo=useRef();\r\n  let curTracks;\r\n\r\n  useEffect(()=> {\r\n    //console.log(\"In useEffect\")\r\n    axios('https://api.spotify.com/v1/me', {\r\n        method: 'GET',\r\n        headers: {'Authorization' : 'Bearer ' + props.logInfo}\r\n      })\r\n      .then((response) => {\r\n        userInfo.current=response.data;\r\n      })\r\n  },[props.logInfo]);\r\n\r\n  useEffect(() => {\r\n    const handleClickInside = event=>{\r\n      if(open && props.inputRef.current.contains(event.target)){\r\n        setOpen(false);\r\n      }\r\n      else if(props.inputRef.current.contains(event.target)){\r\n        setOnlineClicked(true);\r\n      }\r\n      else if (document.activeElement.className!==\"AddButton\"){\r\n        setOnlineClicked(false);\r\n        if(open){\r\n          setOpen(false);\r\n        }\r\n      }\r\n    }\r\n    document.addEventListener(\"click\", handleClickInside);\r\n    return () => {\r\n      document.removeEventListener(\"click\", handleClickInside);\r\n    };\r\n  }, [open])\r\n\r\n  const addSongClicked=async addingId=>{\r\n    let addSong=false;\r\n    curTracks = await props.getPlaylist(0, curTracks, addingId);\r\n    for(const item of curTracks){\r\n      if(item.track.uri===addingTrack.current){\r\n        alert(\"Song already in the playlist\")\r\n        break;\r\n      }\r\n      else if(item===curTracks[curTracks.length-1]){\r\n        addSong=true;\r\n      }\r\n    }\r\n    if(addSong){\r\n      curTracks=null;\r\n      axios(`https://api.spotify.com/v1/playlists/${addingId}/tracks`, {\r\n        method: \"POST\",\r\n        headers: {'Authorization' : 'Bearer ' + props.logInfo},\r\n        data: { \"uris\": [addingTrack.current]}\r\n      })\r\n      .then (async _ => {\r\n        curTracks = await props.getPlaylist(0, curTracks, addingId);\r\n        if(addingId===props.playlists.current.selectedPlaylist){\r\n          props.setDispPlaylist(curTracks);\r\n          if(props.playlistTrack.current===props.playlists.current.selectedPlaylist){\r\n            props.setTracks({selectedTrack: props.tracks.selectedTrack, listOfTracksFromApi: curTracks});\r\n          }\r\n        }\r\n        else if(props.playlistTrack.current===addingId){\r\n          props.setTracks({selectedTrack: props.tracks.selectedTrack, listOfTracksFromApi: curTracks});\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  const seePlaylists=e=>{\r\n    document.getElementById(\"PopUp\").style.marginTop=e.currentTarget.id+\"px\";\r\n    if(!open || (addingTrack.current && addingTrack.current===e.currentTarget.value)){\r\n      setOpen(!open);\r\n    }\r\n    addingTrack.current=e.currentTarget.value;\r\n  }\r\n\r\n  const addTheSong=e=> {\r\n    addSongClicked(e.target.id);\r\n  };\r\n\r\n  return (onlineClicked && props.songs ?(\r\n    <div className=\"AboveOnline\">\r\n      <div className= \"Online\">\r\n        <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\"/ >\r\n        {typeof props.songs ===\"object\" ?\r\n          props.songs.tracks.items.map((item, idx) =>\r\n            <div className=\"AddParent\" key={idx}><button id={idx*23+57} value = {item.uri} onClick={seePlaylists} className=\"AddButton\">\r\n              <i className=\"fa fa-plus\"></i><div className=\"AddMessage\" >&nbsp;Add to playlist</div></button>{item.name}: {item.artists[0].name}</div>) :\r\n          <div> '{props.songs}' does not exist </div>}\r\n      </div>\r\n      <div id =\"PopUp\" className=\"PopUp\">\r\n      {open && props.playlists.current.listOfPlaylistsFromAPI.map((item, idx) => userInfo.current.display_name===item.owner.display_name &&\r\n        <button className=\"AddToPlay\" key={idx} id = {item.id} onClick={addTheSong}>{item.name}</button>\r\n      )}\r\n      </div>\r\n    </div>): null\r\n  );\r\n})\r\nexport default Online;\r\n"]},"metadata":{},"sourceType":"module"}